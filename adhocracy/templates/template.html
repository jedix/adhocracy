<%namespace name="model" module="adhocracy.model"/>
<%namespace name="components" file="/components.html"/>

<%def name="title()">${_("No Title")}</%def>
<%def name="page_title()"><h1>${self.title()}</h1></%def>
<%def name="breadcrumbs()">&nbsp;</%def>
<%def name="contextbox()">&nbsp;</%def>

<%def name="page_actions()"></%def>
<%def name="page_actions_bar()">
	<div id="page_actions">
		${self.page_actions()}
	</div>
</%def>

<%def name="print_meta()">
	%for key, value in c.html_meta.items():
		<meta name="${key}" content="${value}" />
	%endfor
</%def>

<%def name="print_link()">
	%for link in c.html_link:
		<link rel="${link['rel']}" type="${link['type']}" title="${link['title']}" href="${link['href']}" />
	%endfor
</%def>


<!DOCTYPE html>
<html>
<head>
	<title>${self.title()} - 
		   	%if c.instance:
				 ${c.instance.label} 
		   	%endif
			${config.get('adhocracy.site.name')}</title>
	<link href="/style/base.css" rel="stylesheet" type="text/css" />
	<link type="text/css" href="http://jqueryui.com/latest/themes/base/ui.all.css" rel="stylesheet" />
	<link href="/style/site.css" rel="stylesheet" type="text/css" />
	<link media="only screen and (max-device-width: 480px)" href="/style/iphone.css" type="text/css" rel="stylesheet" />
	<link rel="stylesheet" href="/style/print.css" type="text/css" media="print" />
	<link href='/favicon.ico' rel='shortcut icon' type='image/x-icon' />
	${print_link()}
	
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	${print_meta()}
	
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.1/jquery.min.js"></script>
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.2/jquery-ui.min.js"></script>
	<script type="text/javascript" src="/js/jquery.autocomplete.min.js"></script>	
	<script type="text/javascript" src="/js/jquery.cookie.js"></script>
	<script type="text/javascript" src="/js/jquery.timeago.js"></script>
	<script type="text/javascript" src="/js/jquery.timeago.${c.locale.language}.js"></script>
	<script type="text/javascript" src="/js/adhocracy.js"></script>
</head>
<body>
<div id="frame">
	<div id="header">
		<form action="/search" method="GET">
		<div id="center">
			<div id="account">
			%if not c.user:
				<a href="/login">${_("sign in")}</a> &middot;
				<a href="/register">${_("create an account")|n}</a>
			%else:
				<img src="${h.gravatar_url(c.user, size=16)|n}">
				<a class="user_name" href="/user/${c.user.user_name}">${c.user.name}</a>
				%if h.has_permission("vote.cast"):
					&middot; <a href="/user/${c.user.user_name}/votes">${_("votes")}</a>
					&middot; <a href="/user/${c.user.user_name}/delegations">${_("delegations")}</a>						
				%endif
				%if c.instance and not c.user.is_member(c.instance):
					&middot; 
					<a class="join" href="/instance/${c.instance.key}/join?${h.url_token()}">${_("join %s") % c.instance.label}</a>	
				%endif 
				&middot; <a href="/user/${c.user.user_name}/edit">${_("settings")}</a>
				&middot; <a href="/logout">${_("logout")}</a>
			%endif
			</div>
			<a href="/"><img id="logo" src="/instance/icon/${c.instance.key if c.instance else '_def'}-64x64.png" /></a>
			<div id="menu">
			<ul>
				%if not c.instance:
					<li><a href="/">${_("Home")}</a></li>
				%endif
				%if c.instance:
					<li><a href="/instance/${c.instance.key}">${_("Issues")}</a></li>
					<li><a href="/polls">${_("Polls")}</a></li>
					<!-- li><a href="/adopted">${_("Outcomes")}</a></li  -->
					%if h.has_permission("instance.admin"):
						<li><a href="/instance/edit/${c.instance.key}">${_("Manage")}</a></li>
					%endif
				%endif
				%if h.has_permission("global.admin") and False:
					<li><a href="/admin/permissions">${_("Admin")}</a></li>
				%endif
				<li><a href="/adhocracies">${_("Adhocracies")}</a></li>
				<li><a href="/user">${_("Users")}</a></li>
			</ul>
			
			<label id="searchlabel" for="serp_q" class="armhint">${_("Search")}</label>
			<input id="search" name="serp_q" class="armlabel" />	
			</div>
		</div>
		</form>
	</div>
	<%def name="page()">
	<div id="page">
		<div id="breadcrumbs">
			${self.breadcrumbs()}
		</div>	
		<% messages = h.flash.pop_messages() %>
		%if messages:
		<div id="flash_messages">
			<ul>
			%for message in messages:
	    		<li>${message}</li>
	    	%endfor
			</ul>
		</div>
		%endif
	
		<div id="content">
			${self.body()}
		</div>
	</div>
	</%def>
	
	<%def name="tpl_page()">
		${self.page()}
	</%def>
	
	${self.tpl_page()}
</div>

<div id="footer">
	<div id="links">
		<div id="license">
			<a class="nolink" rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/de/">
				<img alt="Creative Commons License" src="http://i.creativecommons.org/l/by-sa/3.0/de/80x15.png" />
			</a>
		</div>
		
		<a class="nolink" href="http://liqd.net"><img id="button" src="/img/liqd_ev.png"/></a>
		<a class="nolink" href="http://wiki.liqd.net/Adhocracy">${_("adhocracy &middot; liquid democracy platform")|n}</a><br/>
		<a href="/page/about.html">${_("about")}</a> &middot;
		<a href="http://wiki.liqd.net/Adhocracy/Handbuch">${_("help")}</a> &middot; 
		<a href="http://trac.adhocracy.de/newticket">${_("report a problem")}</a> &middot;
		<a href="/page/privacy.html">${_("privacy")}</a> &middot; 
		<a href="/page/imprint.html">${_("imprint")}</a> &middot;
		${c.lib.get_version()}
	</div>
</div>
</body>
</html>