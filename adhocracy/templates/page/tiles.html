<%namespace name="components" file="/components.html"/>

<%def name="row(tile, page)">
	<div class="tile">
		<div class="base" style="background-image: url(/img/icons/page_32.png);">
			<h3><a class="link" href="${h.entity_url(page)}">${page.title}</a></h3>
			##%for (tag, count) in page.tags[:5]:
			##	${h.tag_link(tag)|n}
			##%endfor
			<div class="meta noclear">				
				<img src="/img/icons/discuss_16.png" /> 
				${ungettext("%s comment", "%s comments", page.comment_count()) % page.comment_count()},
				${_("latest <b>%s</b>") % h.relative_time(tile.latest_revision_time)|n}&nbsp;
			</div>
		</div>
	</div>
</%def>


<%def name="select_page(tile, field_name, exclude, functions, list_limit)">
	%if list_limit is not None and c.model.Page.count(instance=c.instance, exclude=exclude, functions=functions) > list_limit: 
		<input name="${field_name}" />
	%else:
		<select name="${field_name}"> 
		%for page in c.model.Page.all(instance=c.instance, exclude=exclude, functions=functions):
			<option value="${page.label}">${page.title}</option>
		%endfor
		</select>
	%endif 
</%def>



<%def name="inline(tile, page, text)">
	${tiles.text.full(text)}
</%def>

<%def name="header(tile, page, active, text, variant)">
	<div class="top_actions title">
		%if can.delegation.create():
			<a class="button title add ttip" title="${_('Delegate your say in this debate to another participant.')}" 
			    href="/delegation/new?scope=${page.id}">${_("delegate")}</a>
		%endif
		
		%if can.page.variant_edit(page, variant):
			<a class="button title edit" 
				href="${h.entity_url(text, member='edit')}">${_("edit")}</a>
		%endif
						
		%if can.page.delete(page):
			<a class="button title delete" 	
				href="${h.entity_url(page, member='ask_delete')}">${_("delete")}</a>
		%endif
		
		${components.watch(page)}
		${h.rss_button(page)|n}
	</div>
	
	<div style="clear: both;"></div>
	<h1 class="page_title">
	%if text.variant != text.HEAD:
		${_("Change request: %s") % text.title}
	%else:
		${text.title}
	%endif
	</h1>
</%def>


