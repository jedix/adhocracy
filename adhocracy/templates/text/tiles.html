<%namespace name="comment_tiles" file="/comment/tiles.html"/>

<%def name="history_row(tile, text)">
	<div class="tile text history">
		<ul>
			%if (not text.parent) or text.parent.title != text.title:
				<li>${tile.parent_title_diff|n}</li>
			%endif
			%if text.page.has_variants:
				<li>${text.variant}</li>
			%endif
			<li>${_("by %s, ") % h.user_link(text.user, scope=text.page)|n}
					${_("created %s") % h.relative_time(text.create_time)|n}</li>
		</ul>
	</div>
	
	<div class="headrev">
			%if text.has_text:
				<div class="text">
					${tile.parent_text_diff|n}
				</div>
			%else:
				<div class="infobox">
					${_("This revision has no text.")}
				</div>
			%endif
	</div>
</%def>


<%def name="full(tile, text, subpages_pager=None)">
	%if text.has_text:
		<div class="tile">
		${text.render()|n}
		</div>
	%else:
		<div class="infobox">
			%if text.page.function == text.page.NORM:
				${_("This norm has not yet been decided and is thus no official position of this group.")}
			%else:
				${_("This document has no text yet.")}
			%endif
		</div>
	%endif
	%if subpages_pager is not None and len(subpages_pager._items):
		<h2>${_("Subpages")}</h2>
		<div id="pages_table" class="table">
			${subpages_pager.here()}
		</div>
	%endif
	${tiles.comment.list(text.page, variant=text.variant)}
</%def>



<%def name="descbox(tile, this, other, options, field)">
	%if options:
		<form action="/page/diff" method="GET" id="diff_left_form">	
		<input type="hidden" name="right" value="${other.id}" />
	%endif
	
	<div class="infobox">
		<ul>
			%if this.title != other.title:
				<li>${_("Title:")|n} <b><a href="${h.entity_url(this)|n}">${this.title}</a></b></li>
			%endif
			<li>
			%if options:
				${_("Variant:")|n}
				<select name="left" id="diff_left_select">
					%for text in options:
						%if text == this:
							<option value="${text.id}" selected="selected">${text.variant_title}</option>
						%elif text == other:
							<!-- nop -->
						%else:
							<option value="${text.id}">${text.variant_title}</option>
						%endif
					%endfor
				</select>
				<a href="${h.entity_url(this)|n}">${_("see")}</a>
			%else:
				${_("Variant:")} 
				%if field is not None:
					<label for="variant" class="armhint">${_("Variant Name")}</label>
					<input class="armlabel" name="variant" maxlength="75" value="${field}"/>
					<div class="help">
						&middot; ${h.help_link(_("help"), 'selection_faq', anchor='whatisvariant')|n}
					</div>
				%else:
					<b><a href="${h.entity_url(this)|n}">
					%if this.variant == c.model.Text.HEAD:
						${_("Status quo")}
					%else:
						${this.variant}
					%endif
					</a></b>
				%endif
			%endif
			
			</li>
			<li>
				${_("%s by %s") % (h.relative_time(this.create_time), 
													 h.user_link(this.user, scope=this.page))|n}
				&middot; <b><a href="${h.entity_url(this, member='history')|n}">${_("historic versions")}</a></b>
			</li>
		</ul>
		%if options:
			<noscript>
				<input type="submit" value="${_("Compare")}" />
			</noscript>
		%endif
	</div>
	
	%if options:
		</form>
	%endif
</%def>

